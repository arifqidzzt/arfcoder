{{define "admin_content"}}
<!-- ADMIN USERS -->
<div x-data="adminUsers()">
    <h1 class="text-2xl font-bold mb-8">Kelola Pengguna</h1>
    <div class="bg-white rounded-2xl border border-border overflow-hidden">
        <table class="w-full">
            <thead class="bg-gray-50 border-b">
                <tr>
                    <th class="p-4 text-left text-sm font-medium">Pengguna</th>
                    <th class="p-4 text-left text-sm font-medium">Email</th>
                    <th class="p-4 text-left text-sm font-medium">Role</th>
                    <th class="p-4 text-left text-sm font-medium">Status</th>
                    <th class="p-4 text-left text-sm font-medium">Aksi</th>
                </tr>
            </thead>
            <tbody>
                <template x-for="user in users" :key="user.id">
                    <tr class="border-b">
                        <td class="p-4">
                            <div class="flex items-center gap-3"><img :src="user.avatar || 'https://placehold.co/40'"
                                    class="w-10 h-10 rounded-full"><span x-text="user.name"></span></div>
                        </td>
                        <td class="p-4 text-sm" x-text="user.email"></td>
                        <td class="p-4"><span class="px-2 py-1 rounded-full text-xs font-bold"
                                :class="user.role === 'admin' ? 'bg-purple-100 text-purple-700' : 'bg-gray-100'"
                                x-text="user.role"></span></td>
                        <td class="p-4"><span class="px-2 py-1 rounded-full text-xs font-bold"
                                :class="user.isVerified ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'"
                                x-text="user.isVerified ? 'Verified' : 'Unverified'"></span></td>
                        <td class="p-4"><button @click="toggleRole(user)" class="text-blue-600 mr-3"
                                x-text="user.role === 'admin' ? 'Jadikan User' : 'Jadikan Admin'"></button></td>
                    </tr>
                </template>
            </tbody>
        </table>
    </div>
</div>
<script>
    function adminUsers() {
        return {
            users: [],
            async init() { try { const data = await api.get('/admin/users'); this.users = data || []; } catch (e) { } },
            async toggleRole(user) { try { await api.put(`/admin/users/${user.id}/role`, { role: user.role === 'admin' ? 'user' : 'admin' }); showToast('Role diperbarui', 'success'); await this.init(); } catch (e) { showToast(e.message, 'error'); } }
        };
    }
</script>
{{end}}
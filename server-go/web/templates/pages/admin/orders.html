{{define "admin_content"}}
<!-- ADMIN ORDERS -->
<div x-data="adminOrders()">
    <h1 class="text-2xl font-bold mb-8">Kelola Pesanan</h1>
    <div class="flex gap-2 mb-6 overflow-x-auto">
        <button @click="status = ''" :class="status === '' ? 'bg-black text-white' : 'bg-white border'"
            class="px-4 py-2 rounded-lg font-medium whitespace-nowrap">Semua</button>
        <button @click="status = 'UNPAID'" :class="status === 'UNPAID' ? 'bg-black text-white' : 'bg-white border'"
            class="px-4 py-2 rounded-lg font-medium">Belum Bayar</button>
        <button @click="status = 'PROCESSING'"
            :class="status === 'PROCESSING' ? 'bg-black text-white' : 'bg-white border'"
            class="px-4 py-2 rounded-lg font-medium">Diproses</button>
        <button @click="status = 'COMPLETED'"
            :class="status === 'COMPLETED' ? 'bg-black text-white' : 'bg-white border'"
            class="px-4 py-2 rounded-lg font-medium">Selesai</button>
    </div>
    <div class="bg-white rounded-2xl border border-border overflow-hidden">
        <table class="w-full">
            <thead class="bg-gray-50 border-b">
                <tr>
                    <th class="p-4 text-left text-sm font-medium">Invoice</th>
                    <th class="p-4 text-left text-sm font-medium">Customer</th>
                    <th class="p-4 text-left text-sm font-medium">Total</th>
                    <th class="p-4 text-left text-sm font-medium">Status</th>
                    <th class="p-4 text-left text-sm font-medium">Tanggal</th>
                    <th class="p-4 text-left text-sm font-medium">Aksi</th>
                </tr>
            </thead>
            <tbody>
                <template x-for="order in filteredOrders" :key="order.id">
                    <tr class="border-b">
                        <td class="p-4 font-mono text-sm" x-text="order.invoiceNumber"></td>
                        <td class="p-4" x-text="order.user?.name"></td>
                        <td class="p-4 font-medium" x-text="formatPrice(order.total)"></td>
                        <td class="p-4"><span class="px-2 py-1 rounded-full text-xs font-bold"
                                :class="order.status === 'COMPLETED' ? 'bg-green-100 text-green-700' : order.status === 'UNPAID' ? 'bg-red-100 text-red-700' : 'bg-orange-100 text-orange-700'"
                                x-text="order.status"></span></td>
                        <td class="p-4 text-sm text-gray-500" x-text="formatDate(order.createdAt)"></td>
                        <td class="p-4"><select x-model="order.status" @change="updateStatus(order)"
                                class="p-2 border rounded-lg text-sm">
                                <option value="UNPAID">Belum Bayar</option>
                                <option value="PROCESSING">Diproses</option>
                                <option value="COMPLETED">Selesai</option>
                            </select></td>
                    </tr>
                </template>
            </tbody>
        </table>
    </div>
</div>
<script>
    function adminOrders() {
        return {
            orders: [], status: '',
            get filteredOrders() { return this.status ? this.orders.filter(o => o.status === this.status) : this.orders; },
            async init() { try { const data = await api.get('/admin/orders'); this.orders = data || []; } catch (e) { } },
            async updateStatus(order) { try { await api.put(`/admin/orders/${order.id}/status`, { status: order.status }); showToast('Status diperbarui', 'success'); } catch (e) { showToast(e.message, 'error'); } }
        };
    }
</script>
{{end}}
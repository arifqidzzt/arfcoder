<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>{{.Title}} | ArfCoder</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Animations (AOS) -->
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />

    <!-- Scripts -->
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#000000',
                        accent: '#5e5ce6',
                        background: '#ffffff',
                        border: '#e5e7eb',
                    },
                    boxShadow: {
                        'soft': '0 4px 20px -4px rgba(0, 0, 0, 0.08)',
                        'elevated': '0 12px 40px -8px rgba(0, 0, 0, 0.12)',
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; overflow-x: hidden; }
        [xl-cloak] { display: none !important; }
        .text-gradient {
            background: linear-gradient(135deg, #5e5ce6, #b06ab3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #e5e7eb; border-radius: 10px; }
        
        /* HTMX Loading Indicator */
        .htmx-indicator { opacity: 0; transition: opacity 200ms ease-in; }
        .htmx-request .htmx-indicator { opacity: 1; }
        .htmx-request.htmx-indicator { opacity: 1; }
    </style>
</head>
<body class="bg-white text-black min-h-screen flex flex-col" hx-boost="true">
    
    {{template "partials/navbar" .}}

    <main id="main-content" class="flex-grow">
        {{embed}}
    </main>

    {{template "partials/footer" .}}

    {{template "partials/chat_widget" .}}

    <!-- Notifications Toast -->
    <div id="toast-container" class="fixed bottom-5 right-5 z-[100] flex flex-col gap-2"></div>

    <!-- Animation Script -->
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
    <script>
        // Init Animations
        AOS.init({
            duration: 800,
            once: true,
            offset: 50,
            easing: 'ease-out-cubic'
        });

        // Simple Toast Notification Logic
        window.toast = (message, type = 'success') => {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            const bgColor = type === 'success' ? 'bg-black' : 'bg-red-600';
            toast.className = `${bgColor} text-white px-6 py-3 rounded-xl shadow-2xl animate-bounce flex items-center gap-2 text-sm font-bold`;
            toast.innerHTML = message;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        };

        // HTMX Hooks
        document.body.addEventListener('htmx:afterOnLoad', function(evt) {
            if (evt.detail.xhr.status >= 400) {
                const response = JSON.parse(evt.detail.xhr.responseText);
                toast(response.message || 'Terjadi kesalahan', 'error');
            }
        });

        // Re-init Animations and Scroll after page swap
        document.body.addEventListener('htmx:afterSwap', function(evt) {
            AOS.refreshHard();
            window.scrollTo(0, 0);
        });
    </script>
</body>
</html>
